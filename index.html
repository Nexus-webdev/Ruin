<!DOCTYPE html>
<html lang='en'>
 <head>
  <meta charset='UTF-8' content-type='utf-8'>
  <meta name='viewport' content='width=device-width, initial-scale=1.0'>
  <meta name='description' content='Decides whether the Ruin Manager or Output page is used.'>
  <link rel='manifest' href='manifest.json'>
  
  <link rel='icon' href='icons/rre.png' type='image/png'>
  <title>Decider</title>
  <p>Press Shift To Change</p>
  <p>Press Enter To Confirm</p>
  <p>Or Install As An App</p>
  
  <script>
   let type = urlData()?.type?.toLowerCase?.();
   const urls = {
    default: 'https://nexus-webdev.github.io/Ruin',
    runtime: 'https://nexus-webdev.github.io/Ruin/Output.html?',
    manager: 'https://nexus-webdev.github.io/Ruin/Manager.html?',
   };
   
   const site_names = `(${Object.keys(urls).join('|')})`;
   const validSite = site_names.includes(type);
   if (!type || !validSite) ask();
   
   document.addEventListener('keydown', e => {
    if (e.shiftKey) ask();
    if (e.key == 'Enter')
    {
     const validSite = site_names.includes(type);
     const site_url = urls[validSite ? type : 'default'];
     location.href = site_url;
    }
   })
   
   const path = './service_worker.js';
   if ('serviceWorker' in navigator && location.href.includes('https'))
   navigator.serviceWorker.register(path).then(_ => _).catch(err => {
    console.error(`Service Worker '${path}' failed`, err);
   });
   
   function ask() {
    type = prompt('Enter the desired site ' +site_names, type || '')?.trim?.()?.toLowerCase?.();
   }
   
   function urlData() {
    const Params = new URLSearchParams(window.location.search).entries();
    const data = {};
    
    for (let param of Params)
    data[param[0]] = param[1];
    return data;
   }
  </script>
 </head>
</html>