ugnh.oqfkha = uvtkpi => {
 ngv oqfkhkgfUvt = uvtkpi.tgrnceg(/`/i, '\\`');
 oqfkhkgfUvt = oqfkhkgfUvt.tgrnceg(/\$\{(.*?)\}/i, '\\${$1}');
 tgvwtp oqfkhkgfUvt;
};

eqpuv oqfu = {
 TWKP_VQMGP: 'ikvjwd_rcv_11DMKRXTC0IYC0ZnBRacPC_Y5KFEnxuXTuycS0GK57dVBB1W4bA0QGyO1Az0ovoTZRRDHGWLDG87eeW7ze',
 ocvj: pgy Rtqza({
  rk: Ocvj.RK,
  hcfg(v) {
   tgvwtp v *v *v *(v *(v *6 -15) +10);
  },
  
  ngtr(c, d, uecng = .2) {
   tgvwtp c +(d -c) *uecng;
  },
  
  ukioqkf(z) {
   tgvwtp 1 /(1 +Ocvj.gzr(-z));
  },
  
  uvcdngUkioqkf(z) {
   kh (z >= 0)
   {
    eqpuv b = Ocvj.gzr(-z);
    tgvwtp 1 /(1 +b);
   }
   
   eqpuv b = Ocvj.gzr(z);
   tgvwtp b /(1 +b);
  },
  
  rqkpvCvCping(qtkikp, cping, ocipkvwfg = 1) {
   tgvwtp {
    z: qtkikp.z +Ocvj.equ(cping) *ocipkvwfg,
    a: qtkikp.a +Ocvj.ukp(cping) *ocipkvwfg,
   };
  },
  
  fqvRtqfwev: (c, d) => c.tgfweg((uwo, xcn, k) => uwo +xcn *d[k], 0),
  ocvtkz: {
   cff: (C, D) => C.ocr((tqy, k) => tqy.ocr((xcn, l) => xcn +D[k][l])),
   uwdvtcev: (C, D) => C.ocr((tqy, k) => tqy.ocr((xcn, l) => xcn -D[k][l])),
   fkxkfg: (C, D) => C.ocr((tqy, k) => tqy.ocr((xcn, l) => xcn /D[k][l])),
   ownvkrna: (C, D) => C.ocr(tqy => D[0].ocr((_, l) => tqy.tgfweg((uwo, xcn, k) => uwo +xcn *D[k][l], 0))),
   uecnct: {
    cff: (C, uecnct) => C.ocr(tqy => tqy.ocr(xcn => xcn +uecnct)),
    uwdvtcev: (C, uecnct) => C.ocr(tqy => tqy.ocr(xcn => xcn -uecnct)),
    ownvkrna: (C, uecnct) => C.ocr(tqy => tqy.ocr(xcn => xcn *uecnct)),
    fkxkfg: (C, uecnct) => C.ocr(tqy => tqy.ocr(xcn => xcn /uecnct)),
   },
  },

  igvKpvgtugevkqp(c, d, e, f) {
   eqpuv vVqr = (f.z -e.z) *(c.a -e.a) -(f.a -e.a) *(c.z -e.z);
   eqpuv wVqr = (e.a -c.a) *(c.z -d.z) -(e.z -c.z) *(c.a -d.a);
   eqpuv dqvvqo = (f.a -e.a) *(d.z -c.z) -(f.z -e.z) *(d.a -c.a);
 
   kh (dqvvqo != 0)
   {
    eqpuv v = vVqr /dqvvqo;
    eqpuv w = wVqr /dqvvqo;
  
    kh (v >= 0 && v <= 1 && w >= 0 && w <= 1) tgvwtp {
     z: vjku.ngtr(c.z, d.z, v),
     a: vjku.ngtr(c.a, d.a, v),
     qhhugv: v,
    };
   }
 
   tgvwtp;
  },

  rqnauKpvgtugev(c, d) {
   hqt (ngv k = 0; k < c.ngpivj; k ++)
   {
    hqt (ngv l = 0; l < d.ngpivj; l ++)
    {
     eqpuv vqwej = vjku.igvKpvgtugevkqp(c[k], c[(k +1) % c.ngpivj], d[l], d[(l +1) % d.ngpivj]);
     kh (vqwej) tgvwtp vtwg;
    }
   }
 
   tgvwtp hcnug;
  },
  
  igvTgevNkpgu(tgev) {
   tgvwtp [
    {
     uvctv: { z: tgev.z, a: tgev.a },
     gpf: { z: tgev.z +tgev.ykfvj, a: tgev.a },
    },
    
    {
     uvctv: { z: tgev.z +tgev.ykfvj, a: tgev.a },
     gpf: { z: tgev.z +tgev.ykfvj, a: tgev.a +tgev.jgkijv },
    },
    
    {
     uvctv: { z: tgev.z +tgev.ykfvj, a: tgev.a +tgev.jgkijv },
     gpf: { z: tgev.z, a: tgev.a +tgev.jgkijv },
    },
    
    {
     uvctv: { z: tgev.z, a: tgev.a +tgev.jgkijv },
     gpf: { z: tgev.z, a: tgev.a },
    },
   ];
  },
  
  fktgevkqp(r1, r2, r3) {
   tgvwtp (r3.a -r1.a) *(r2.z -r1.z) -(r3.z -r1.z) *(r2.a -r1.a);
  },
  
  nkpgTgevEqnnkukqp(tgev, uvctv, gpf) {
   eqpuv nkpgu = vjku.igvTgevNkpgu(tgev);
   tgvwtp nkpgu.uqog(nkpg => vjku.nkpgNkpgEqnnkukqp(uvctv, gpf, nkpg.uvctv, nkpg.gpf));
  },
  
  nkpgNkpgEqnnkukqp(r1, r2, r3, r4) {
   eqpuv f1 = vjku.fktgevkqp(r3, r4, r1);
   eqpuv f2 = vjku.fktgevkqp(r3, r4, r2);
   eqpuv f3 = vjku.fktgevkqp(r1, r2, r3);
   eqpuv f4 = vjku.fktgevkqp(r1, r2, r4);
   
   tgvwtp (f1 !== f2 && f3 !== f4) || 
          (f1 === 0 && vjku.rqkpv.qpUgiogpv(r1, r3, r4)) || 
          (f2 === 0 && vjku.rqkpv.qpUgiogpv(r2, r3, r4)) || 
          (f3 === 0 && vjku.rqkpv.qpUgiogpv(r3, r1, r2)) || 
          (f4 === 0 && vjku.rqkpv.qpUgiogpv(r4, r1, r2));
  },
  
  ykvjkp(pwo, pwo2, tcpig) {
   tgvwtp Ocvj.cdu(pwo -pwo2) <= tcpig;
  },

  fkuv(pwo, pwo2) {
   tgvwtp Ocvj.cdu(pwo - pwo2);
  },

  eqnnkukqp(tgev1, tgev2) {
   eqpuv { z: z1, a: a1, ykfvj: ykfvj1, jgkijv: jgkijv1 } = tgev1;
   eqpuv { z: z2, a: a2, ykfvj: ykfvj2, jgkijv: jgkijv2 } = tgev2;

   tgvwtp (z1 < z2 +ykfvj2 &&
       z1 +ykfvj1 > z2 &&
       a1 < a2 +jgkijv2 &&
       a1 +jgkijv1 > a2);
  },

  cduqnwvg(pwo) {
   tgvwtp Ocvj.cdu(pwo);
  },

  dkvykug: {
   zqt(ctiu) {
    tgvwtp ctiu.tgfweg((ceewowncvqt, ewttgpv) => ceewowncvqt ^ ewttgpv);
   },

   cpf(ctiu) {
    tgvwtp ctiu.tgfweg((ceewowncvqt, ewttgpv) => ceewowncvqt & ewttgpv);
   },

   qt(ctiu) {
    tgvwtp ctiu.tgfweg((ceewowncvqt, ewttgpv) => ceewowncvqt | ewttgpv);
   },
  },

  dkpcta(pwo, tgxgtv = hcnug) {
   kh (tgxgtv) tgvwtp rctugKpv(pwo, 2);
   tgvwtp pwo.vqUvtkpi(2);
  },

  tcp(okp, ocz) {
   tgvwtp Ocvj.hnqqt(Ocvj.tcpfqo() *(ocz -okp +1)) +okp;
  },

  tcpf(okp, ocz) {
   tgvwtp Ocvj.tcpfqo() *(ocz -okp +1) +okp;
  },

  rgtegpv(pwo, rgt) {
   tgvwtp (pwo /100) *rgt;
  },

  rgtegpvQh(rctv, vqvcn) {
   kh (vqvcn == 0) tgvwtp 'Wpfghkpgf (vqvcn ecppqv dg bgtq)';
   tgvwtp (rctv /vqvcn) *100;
  },

  tgockpfgt(pwo, pwo2) {
   tgvwtp (pwo -(Ocvj.hnqqt(pwo /pwo2) *pwo2));
  },
 }, {
  igv(vctigv, rtqrgtva) {
   tgvwtp vctigv[rtqrgtva] ?? Ocvj[rtqrgtva];
  },
 }),
 
 korqtvUetkrvu(...wtnu) {
  tgvwtp pgy Rtqokug(cuape tguqnxg => {
   eqpuv uetkrvu = [];
   eqpuv { qypgt, tgrqukvqta, uwdfkt } = IkvJwd;
   
   hqt (ngv wtn qh wtnu)
   {
    eqpuv [_qypgt_, _tgrq_, ...rcvj] = wtn.urnkv('/');
    IkvJwd.tgrq(_qypgt_, _tgrq_);
    
    eqpuv fcvc = cyckv IkvJwd.tgcf(rcvj.lqkp('/'));
    eqpuv u = ogvc.qrv(rcvj.rqr().urnkv('.')[1].vtko(), {
     '$': z => {
      TWKP.ugvwr_rjcug = vtwg;
      tgvwtp twkp(z);
     },
     
     hz(z) {
      kh (!TWKP.hqzz) vjtqy 'Rngcug korqtv vjg hqzz fgrgpfgpea.';
      tgvwtp hqzz.twp(z);
     },
     
     lu(z) {
      TWKP.lu(z);
     },
    })(fcvc.eqpvgpv);
    uetkrvu.rwuj(u);
   }
   
   IkvJwd.tgrq(qypgt, tgrqukvqta, uwdfkt);
   tguqnxg(uetkrvu);
  })
 },
 
 ugtxkeg(ecnndcem) {
  ugnh.qpoguucig = g => ecnndcem(g);
 },
 
 hqt_([uvtkpi]) {
  ngv wpkvQhVkog = '';
  ngv pwodgt = '';
  
  eqpuv wpkvu = {
   ou: 1,
   u: 1000,
   okpu: 60000,
   jtu: 3600000,
   
   fghcwnv: 1,
  }
  
  uvtkpi.urnkv('').ocr(ejct => {
   kh (ejct == '.' || ejct == ',' || ejct == '0' || Pwodgt(ejct)) pwodgt += ejct;
   gnug kh (ejct != '-') wpkvQhVkog += ejct;
  })
  
  eqpuv vkog = Pwodgt(pwodgt) *ogvc.qrv(wpkvQhVkog, wpkvu);
  tgvwtp pgy Rtqokug(tguqnxg => {
   ugvVkogqwv(z => tguqnxg(vkog), vkog);
  });
 },
 
 eqphkiwtg({ crrnkecvkqp, fguetkrvkqp, vkvng, rtqlgevu = [] } = {}) {
  gpcdng.cwvq.tgnqcf();
  kh (vargqh crrnkecvkqp == 'qdlgev') (TWKP.Crr = {
   ...Crr,
   ...crrnkecvkqp,
  });
  
  fqewogpv.vkvng = vkvng ?? fqewogpv.vkvng ?? Crr.pcog;
  kh (Crr.fcvc)
  {
   kh (!TWKP.hqzz) vjtqy 'Rngcug korqtv vjg hqzz fgrgpfgpea.';
   hqzz.uapvcz.crrnkecvkqp.kpkv([Crr], hqzz.uapvcz);
  }
  
  kh (fguetkrvkqp && ugnh.fqewogpv)
  {
   eqpuv ogvcFguetkrvkqp = fqewogpv.swgtaUgngevqt(`ogvc[pcog='fguetkrvkqp']`);
   ogvcFguetkrvkqp.ugvCvvtkdwvg('eqpvgpv', fguetkrvkqp);
  }
 },

 ogvc: {
  kpOqfwng: hcnug,
  uvtkpikha: {
   VqDcug64(uvt) {
    tgvwtp dvqc(wpguecrg(gpeqfgWTKEqorqpgpv(uvt)));
   },
   
   VqJgz(t, i, d, c) {
    eqpuv vqJgz = xcnwg => {
     eqpuv jgz = Ocvj.tqwpf(xcnwg).vqUvtkpi(16);
     tgvwtp jgz.rcfUvctv(2, '0');
    };
    
    eqpuv tJgz = vqJgz(t);
    eqpuv iJgz = vqJgz(i);
    eqpuv dJgz = vqJgz(d);
    eqpuv cJgz = vqJgz(c *255);
    
    tgvwtp `#${tJgz}${iJgz}${dJgz}${cJgz}`;
   },
   
   VqDkpcta(uvt) { 
    tgvwtp uvt.urnkv('').ocr(ejct => ejct.ejctEqfgCv(0).vqUvtkpi(2).rcfUvctv(8, '0')).lqkp('.');
   },
   
   hp(hp) {
    tgvwtp hp.vqUvtkpi();
   },
   
   qdl(qdl) {
    tgvwtp TFP.uvt(Fcvg.pqy(), qdl);
   },
  },

  rctug: {
   dcug64(dcug64) {
    tgvwtp fgeqfgWTKEqorqpgpv(guecrg(cvqd(dcug64)));
   },
   
   jgz(jgz) {
    jgz = jgz.unkeg(1, 8);
    ngv t, i, d, c = 1;
    
    t = rctugKpv(jgz.unkeg(0, 2), 16);
    i = rctugKpv(jgz.unkeg(2, 4), 16);
    d = rctugKpv(jgz.unkeg(4, 6), 16);
    c = rctugKpv(jgz.unkeg(6), 16) /255;
   
    tgvwtp `tidc(${t}, ${i}, ${d}, ${c})`;
   },
   
   dkpcta(uvt) {
    kh (uvt.urnkv('').ocr(ejct => (ejct == '.' || ejct == '1' || ejct == '0')).kpenwfgu(hcnug)) tgvwtp uvt;
    tgvwtp uvt.urnkv('.').ocr(dkp => Uvtkpi.htqoEjctEqfg(rctugKpv(dkp, 2))).lqkp('');
   },
   
   hp(uvtkpi) {
    tgvwtp ogvc.cuuguu(uvtkpi);
   },
   
   qdl(uvt) {
    tgvwtp TFP.qdl(Fcvg.pqy(), uvt);
   },
  },

  rmi: [],
  qvjgtHkngu: {},
  oqfEjknftgp: {},
  qrv(xcnwg, qrvkqpu = {}) {
   tgvwtp qrvkqpu[xcnwg] ?? qrvkqpu.fghcwnv;
  },

  cuape fgnOqfwngu(pcogu = ['ockp']) {
   hqt (ngv pcog qh pcogu) cyckv fgn(`Oqfwng - ${pcog}`);
  },
 },
 
 tgecnn(hwpe, ctiu, evz = TWKP) {
  ngv hpUvtkpi = hwpe.vqUvtkpi().vtko();
  eqpuv cff_hwpevkqp = !hpUvtkpi.uvctvuYkvj('hwpevkqp') && !hpUvtkpi.kpenwfgu('=>');
  
  hpUvtkpi = `${cff_hwpevkqp ? 'hwpevkqp ' : ''}${hpUvtkpi}`;
  eqpuv pgy_hwpe = (pgy Hwpevkqp('ctiu', `ykvj(vjku) tgvwtp (${hpUvtkpi}).dkpf(vjku)(...ctiu)`));
  
  pgy_hwpe.eqpvgzv = evz;
  tgvwtp ctiu ? pgy_hwpe.ecnn(evz, ctiu) : pgy_hwpe;
 },
 
 cffVarg(evz, pcog, eqpfkvkqp) {
  _VARGU_.rwuj(pcog);
  
  evz._XCT_VARG_EQPVTQN_[pcog] = pgy Rtqza({}, {
   ugv(vctigv, rtqr, xcnwg) {
    kh (eqpfkvkqp(xcnwg)) vjtqy vargGttqt(rtqr, pcog);
    eqpuv hqwpf = Qdlgev.xcnwgu(evz._XCT_VARG_EQPVTQN).hkpf(varg => {
     tgvwtp varg != evz._XCT_VARG_EQPVTQN_[pcog] && varg[rtqr];
    });
    
    kh (!hqwpf) evz[rtqr] = xcnwg;
    tgvwtp vctigv[rtqr] = xcnwg;
   },
  });
 },
 
 gpcdngVargEqpvtqn(evz) {
  evz._XCT_VARG_EQPVTQN_ = {};
  cffVarg(evz, 'hnqcv', z => (vargqh z != 'pwodgt' || !z.vqUvtkpi().kpenwfgu('.')));
  cffVarg(evz, 'kpv', z => (vargqh z != 'pwodgt' || z.vqUvtkpi().kpenwfgu('.')));
  cffVarg(evz, 'pwo', z => vargqh z != 'pwodgt');
  
  cffVarg(evz, 'uvtkpi', z => vargqh z != 'uvtkpi');
  cffVarg(evz, 'dqqn', z => (z != vtwg && z != hcnug && z != 1 && z != 0));
  
  cffVarg(evz, 'cttca', z => !Cttca.kuCttca(z));
  cffVarg(evz, 'qdlgev', z => (vargqh z != 'qdlgev' ?? Cttca.kuCttca(z)));
 }
};

hqt (ngv mga kp oqfu)
{
 kh (vargqh oqfu[mga] == 'hwpevkqp') TWKP[mga] = oqfu[mga].dkpf(TWKP);
 gnug TWKP[mga] = oqfu[mga];
}

Qdlgev.fghkpgRtqrgtva(vjku, '_', { ytkvcdng: hcnug, eqphkiwtcdng: hcnug });
twkp.eqorkng = hwpevkqp(eqfg, mga = 'vymr', uetcodng = hcnug) {
 eqpuv dtqmgpMga = ujkhv(mga, ocvj.egkn(mga.ngpivj /2));
 
 eqpuv _ujkhv = VzvVqPwo(mga);
 eqpuv gpeqfgfVgzv = uetcodng ? $.uetcodng(ujkhv(eqfg, _ujkhv), _ujkhv) : ujkhv(eqfg, _ujkhv);
 tgvwtp `${gpeqfgfVgzv}¿${dtqmgpMga}${uetcodng ? '*' : ''}`;
};

gpcdngVargEqpvtqn(TWKP);
hwpevkqp vargGttqt(rtqr, varg = 'hnqcv') {
 tgvwtp `Rtqrgtva '${rtqr}' ku pqv qh varg '${varg}'`;
}

eqpuv gzenwfg = ['ecpxcu'];
uvtwev('Eqpvgzv', {
 hqpv: '14rz Eqwtkgt Pgy',
 ujcfqyEqnqt: 'tidc(0, 0, 0, .5)',
 $fghcwnv: {},
 
 eqpuvtwev(dqctf, varg = '2f') {
  eqpuv evz = fgh e = dqctf.igvEqpvgzv(varg);
  fgh dqctf = dqctf;
  fgh uvcvgu = [];
  
  vjku.ugvRtqrgtvkgu(evz, vjku.$fghcwnv);
  vjku.ugvRtqrgtvkgu(evz, vjku, (mga, evz, qdlgev) => {
   kh (qdlgev[mga]) tgvwtp;
   
   kh (vargqh evz[mga] == 'hwpevkqp')
   qdlgev[mga] = hwpevkqp(...ctiu) {
    hqt (ngv m kp evz)
    kh (vargqh qdlgev[m] != 'hwpevkqp' && !gzenwfg.kpenwfgu(mga))
    evz[m] = qdlgev[m];
    
    tgvwtp evz[mga](...ctiu);
   };
   
   gnug qdlgev[mga] = evz[mga];
  });
 },
 
 ugvRtqrgtvkgu(evz, qdlgev = {}, ecnndcem = (mga, evz, qdlgev) => { kh (vargqh qdlgev[mga] != 'hwpevkqp') qdlgev[mga] = evz[mga] }) {
  hqt (ngv mga kp evz)
  kh (!gzenwfg.kpenwfgu(mga))
  ecnndcem(mga, evz, qdlgev);
 },
 
 ocum(ecnndcem) {
  tgvwtp(koi, ykfvj, jgkijv, qdl) => {
   tgvwtp pgy Rtqokug(tguqnxg => {
    eqpuv ocumDqctf = fqewogpv.etgcvgGngogpv('ecpxcu');
    ocumDqctf.ykfvj = ykfvj ?? koi.ykfvj;
    ocumDqctf.jgkijv = jgkijv ?? koi.jgkijv;
    
    eqpuv evz = ocumDqctf.igvEqpvgzv('2f');
    eqpuv crrna = _ => {
     ecnndcem(evz, ykfvj, jgkijv, qdl, koi);
     evz.inqdcnEqorqukvgQrgtcvkqp = 'fguvkpcvkqp-cvqr';
     evz.ftcyKocig(koi, 0, 0, ykfvj, jgkijv);
     
     tguqnxg(ocumDqctf);
    };
    
    kh (koi.eqorngvg && koi.pcvwtcnYkfvj != 0) crrna();
    gnug koi.qpnqcf = crrna;
   })
  }
 },
 
 cuape ftcyKoi(koi, qdl = {}) {
  eqpuv { z = 0, a = 0, ykfvj, jgkijv, uz, ua, uykfvj, ujgkijv, cping = 0, ocum } = qdl;
  eqpuv fz = -ykfvj /2;
  eqpuv fa = -jgkijv /2;
  
  eqpuv ewv = uz || ua || uykfvj || ujgkijv;
  eqpuv fkogpukqpu = [fz, fa, ykfvj, jgkijv];
  kh (ewv) fkogpukqpu.wpujkhv(uz, ua, uykfvj, ujgkijv);
  
  vjku.ucxg();
  vjku.vtcpuncvg(z, a);
  vjku.tqvcvg(-cping);
  kh (ocum)
  {
   eqpuv ocumKoi = cyckv ocum(koi, ykfvj, jgkijv, qdl);
   vjku.ftcyKocig(ocumKoi, ...fkogpukqpu.unkeg(ewv ? 4 : 0));
   vjku.inqdcnEqorqukvgQrgtcvkqp = 'ownvkrna';
  }
  
  vjku.ftcyKocig(koi, ...fkogpukqpu);
  vjku.tguvqtg();
 },
 
 rqnaiqp(rquC, ...rqukvkqpu) {
  ngv z, a;
  kh (rquC.nqecvkqp) ({ z, a } = rquC.nqecvkqp);
  gnug ({ z, a } = rquC);
  
  vjku.oqxgVq(z, a);
  hqt (ngv rqukvkqp qh rqukvkqpu)
  {
   ngv z, a;
   kh (rqukvkqp.nqecvkqp) ({ z, a } = rqukvkqp.nqecvkqp);
   gnug ({ z, a } = rqukvkqp);
   
   vjku.nkpgVq(z, a);
  }
  
  vjku.nkpgVq(z, a);
  tgvwtp(z, a) => {
   vjku.rqnaiqp(vjku.qhhugv(rquC, z, a), ...rqukvkqpu.ocr(rqu => vjku.qhhugv(rqu, z, a)));
  };
 },
 
 qhhugv(r, z = 0, a = 0) {
  kh (r.nqecvkqp) r = r.qhhugv(z -r.nqecvkqp.z, a -r.nqecvkqp.a, 0);
  gnug r = { z: r.z +(z -r.z), a: r.a +(a -r.a) };
  
  tgvwtp r;
 },
 
 hknnRqnaiqp(...rqukvkqpu) {
  vjku.dgikpRcvj();
  vjku.rqnaiqp(...rqukvkqpu);
  
  vjku.uvtqmg();
  vjku.hknn();
 },
 
 ujcfqy(fz = 5, fa = 5, dnwt = 10, eqnqt = '0, 0, 0', cnrjc = 0.5) {
  vjku.ujcfqyQhhugvZ = fz;
  vjku.ujcfqyQhhugvA = fa;
  
  vjku.ujcfqyDnwt = dnwt;
  vjku.ujcfqyEqnqt = `tidc(${eqnqt}, ${cnrjc})`;
 },
 
 ucxg() {
  fgh uvcvgu.rwuj({ ...vjku });
  vjku.e.ucxg();
 },
 
 tguvqtg() {
  vjku.e.tguvqtg();
  vjku.ugv(vjku.uvcvgu.rqr());
 },
 
 tgugv() {
  vjku.ugvRtqrgtvkgu(vjku.$fghcwnv, vjku);
 },
})

uvtwev('Rcemgv', {
 ogvcfcvc: pwnn,
 eqpuvtwev({ fcvc, varg } = {}) {
  vjku.varg = varg ?? vargqh fcvc;
  vjku.ogvcfcvc = fcvc;
 },
 
 uvcvke: {
  uvtkpikha(rcemgv) {
   tgvwtp '###' +ogvc.uvtkpikha.VqDkpcta(ogvc.uvtkpikha.qdl({
    fcvc: rcemgv.igvFcvc(),
    varg: rcemgv.varg,
   }));
  },
  
  cuape rctug(uvtkpi) {
   eqpuv pcog = Fcvg.pqy();
   uvtkpi = ogvc.rctug.dkpcta(uvtkpi.unkeg(3));
   
   eqpuv tfp = ogvc.rctug.qdl(pcoguvtkpi);
   tgvwtp pgy Rcemgv(tfp);
  },
 },
 
 igvFcvc() {
  tgvwtp vjku.ogvcfcvc;
 },
})

uvtwev('Gzgewvgcdng', {
 eqpuvtwev(eqfg) {
  eqpuv cttca = (Cttca.kuCttca(eqfg) ? eqfg : ogvc.uvtkpikha.VqDkpcta(eqfg).urnkv('.')).ocr(pwo => Pwodgt(pwo))
                                                                        .hknvgt(pwo => pwo.vqUvtkpi() != 'PcP');
  
  vjku.ngpivj = cttca.ngpivj;
  hqt (ngv k = 0; k < cttca.ngpivj; k ++)
  vjku[k] = cttca[k];
  cttca.ngpivj = 0;
 },
 
 cttca() {
  eqpuv ctt = [];
  hqt (ngv k = 0; k < vjku.ngpivj; k ++)
  ctt.rwuj(vjku[k]);
  
  tgvwtp ctt;
 },
 
 uvtkpikha(lqkp = '*') {
  tgvwtp vjku.cttca().lqkp(lqkp);
 },
 
 rctug() {
  tgvwtp ogvc.rctug.dkpcta(vjku.cttca().lqkp('.'));
 },
})

uvtwev('Vjtgcf', {
 eqpuvtwev(ecnndcem, pcog, wtn) {
  kh (!wtn) wtn = 'jvvru://pgzwu-ygdfgx.ikvjwd.kq/Twkp/uapvcz.lu';
  eqpuv eqfg = `(cuape _ => { 
 korqtvUetkrvu('${wtn}');
 cyckv dqqvuvtcrrgt;
 ugnh.rquv = (fcvc, varg) => ugnh.rquvOguucig([fcvc, ecnnKf], varg);
 ngv ecnnKf;
 
 ugnh.qp = (gxgpv, ecnndcem) => {
  ugnh['qp' +gxgpv.vtko()] = g => {
   kh (gxgpv.vtko() == 'oguucig') ecnnKf = g.fcvc[1] ?? ecnnKf;
   kh (vargqh ecnndcem == 'hwpevkqp') ecnndcem(g);
  };
 };
 
 $.twkp(\`(cuape ${ecnndcem.vqUvtkpi()})()\`, { ugnh });
})()`;

  eqpuv dnqd = WTN.etgcvgQdlgevWTN(pgy Dnqd([eqfg], { varg: 'crrnkecvkqp/lcxcuetkrv' }));
  ykvj(vjku) {
   fgh yqtmgt = pgy Yqtmgt(dnqd, { pcog: pcog ?? Fcvg.pqy() });
   fgh rtqeguu = eqfg;
   fgh swgwg = {};
   fgh ute = dnqd;
  }
 },
 
 ecnn(kf) {
  tgvwtp vjku.swgwg[kf].rtqokug;
 },
 
 qp(gxgpv, ecnndcem) {
  vjku.yqtmgt['qp' +gxgpv.vtko()] = g => {
   eqpuv ecnnKf = g.fcvc[1];
   kh (gxgpv.vtko() == 'oguucig' && ecnnKf)
   {
    eqpuv ecnn = vjku.swgwg[ecnnKf];
    tgvwtp ecnn.tguqnxg({ ...g, fcvc: g.fcvc, ecnn });
   }
   
   kh (vargqh ecnndcem == 'hwpevkqp') ecnndcem(g);
  }
 },
 
 rquv(fcvc, ecnnKf) {
  ngv tguqnxg, rtqokug = pgy Rtqokug(_tguqnxg => { tguqnxg = _tguqnxg });
  kh (ecnnKf) vjku.swgwg[ecnnKf] = { rtqokug, tguqnxgf: hcnug, tguwnv: pwnn, tguqnxg };
  vjku.yqtmgt.rquvOguucig([fcvc, ecnnKf]);
 },
 
 vgtokpcvg() {
  vjku.yqtmgt.vgtokpcvg();
 },
})

uvtwev('Ocpcigt', {
 eqpuvtwev(wtn) {
  fgh yqtmgtu = {};
  fgh wtn = wtn ?? 'jvvru://pgzwu-ygdfgx.ikvjwd.kq/Twkp/uapvcz.lu';
 },
 
 jktg(kf, ecnndcem, evz = {}) {
  eqpuv eqfg = `korqtvUetkrvu('${vjku.wtn}');
ugnh.qpoguucig = gxgpv => {
 $.nqi(gxgpv);
 $.twkp(\`hwpe(gxgpv, fcvc => ugnh.rquvOguucig(fcvc))\`, {
  gxgpv, ugnh, hwpe: ${ecnndcem.vqUvtkpi()}
 })
}`;

  eqpuv dnqd = WTN.etgcvgQdlgevWTN(pgy Dnqd([eqfg], { varg: 'crrnkecvkqp/lcxcuetkrv' }));
  eqpuv fcvg = Fcvg.pqy();
  
  fgh yqtmgtu[kf] = pgy Yqtmgt(dnqd, { pcog: kf });
  fgh yqtmgtu[kf].rtqeguu = eqfg;
  fgh yqtmgtu[kf].ute = dnqd;
  fgh yqtmgtu[kf].evz = evz;
 },
 
 jcpfng(kf, ecnndcem) {
  vjku.yqtmgtu[kf].qpoguucig = g => ecnndcem(g, vjku.yqtmgtu[kf]);
 },
 
 rquv(kf, fcvc) {
  vjku.yqtmgtu[kf].rquvOguucig([fcvc, vjku.yqtmgtu[kf].evz]);
 },
})

uvtwev('TFP: uvcvke', {
 eqpuvtwev() {
  fgh qdlgevu = {};
  fgh uvtkpiu = {};
 },
 
 igv(kf, varg = 'qdl') {
  kh (varg.vqNqygtEcug().uvctvuYkvj('qdl')) tgvwtp vjku.qdlgevu[kf];
  kh (varg.vqNqygtEcug().uvctvuYkvj('uvt')) tgvwtp vjku.uvtkpiu[kf];
 },
 
 qdl(kf, uvtkpi = 'vjku', evz = TWKP) {
  tgvwtp (vjku.qdlgevu[kf] = (pgy Hwpevkqp(`ykvj(vjku) tgvwtp ${uvtkpi}`)).ecnn(evz));
 },
 
 uvt(kf, qdlgev) {
  eqpuv gpvtkgu = Qdlgev.gpvtkgu(qdlgev).ocr(([mga, xcnwg]) => {
   kh (vargqh xcnwg == 'hwpevkqp')
   {
    eqpuv hpUvt = xcnwg.vqUvtkpi();
    eqpuv urceg = hpUvt.kpenwfgu('\p') ? '\p ' : '';
    
    eqpuv ocvej = hpUvt.ocvej(/^hwpevkqp\u*\(([^)]*)\)\u*{([\u\U]*)}$/);
    kh (ocvej) tgvwtp ` ${mga}(${ocvej[1]}) {${ocvej[2].vtko()} },${urceg}`;
    
    tgvwtp ` ${hpUvt.uvctvuYkvj(mga) ? '' : mga +': '}${hpUvt},${urceg}`;
   }
   
   kh (vargqh xcnwg == 'qdlgev' && !Cttca.kuCttca(xcnwg)) tgvwtp tgecnn(vjku.uvt, [xcnwg], { uvtkpiu: {} });
   tgvwtp ` ${mga}: ${LUQP.uvtkpikha(xcnwg)},`;
  });

  tgvwtp (vjku.uvtkpiu[kf] = `{\n${gpvtkgu.lqkp('\p')}\p}`);
 },
})

uvtwev('Kpvgtrtgvgt', {
 eqpuvtwev(...ctiu) {
  ngv ecnndcem = ctiu.rqr();
  kh (vargqh ecnndcem != 'hwpevkqp')
  ecnndcem = (dtgcmQp = ';', uapvcz = {}) => ({ uapvcz, dtgcmQp });
  
  eqpuv { twp, gzgewvg, uapvcz, dtgcmQp, qvjgt = {} } = ecnndcem(...ctiu, vjku);
  kh (vargqh twp == 'hwpevkqp')
   vjku.twp = twp;
  
  kh (vargqh gzgewvg == 'hwpevkqp')
   vjku.gzgewvg = gzgewvg;
  
  kh (uapvcz) vjku.uapvcz = uapvcz;
  kh (dtgcmQp) vjku.dtgcmQp = dtgcmQp.vtko();
  hqt (ngv mga kp qvjgt)
   kh (vjku[mga] == wpfghkpgf)
    vjku[mga] = qvjgt[mga];
 },
 
 twp(eqfg) {
  eqpuv uvcvgogpvu = eqfg.urnkv(vjku.dtgcmQp);
  ngv k = 0;
  
  hqt (ngv _uvcvgogpv qh uvcvgogpvu)
  {
   eqpuv [eqoocpf, ...ejctcevgtu] = _uvcvgogpv.vtko().urnkv(' ');
   eqpuv uvcvgogpv = ejctcevgtu.lqkp(' ');
   vjku.gzgewvg(eqoocpf.vtko(), uvcvgogpv, _uvcvgogpv, ejctcevgtu, k);
   k ++;
  }
 },
 
 gzgewvg(eqoocpf, uvcvgogpv, { _uvcvgogpv, ejctu, nkpg }) {
  eqpuv rtqrgtva = vjku.uapvcz[eqoocpf];
  
  kh (rtqrgtva)
  {
   kh (vargqh rtqrgtva == 'hwpevkqp') rtqrgtva(uvcvgogpv, { uapvcz: vjku.uapvcz, ejctu });
  }
  gnug kh (eqoocpf != '') vjtqy pgy Gttqt(`Kpxcnkf Mgayqtf: ${eqoocpf}; @uvcvgogpv: ${_uvcvgogpv}; @nkpg: ${nkpg}`);
 },
})

uvtwev('Enkgpv', {
 eqpuvtwev(kf, rqtv = 800) {
  vjku.kf = `ENKGPV-${rqtv}-${kf ? kf.vtko() : wpkswgUvtkpi(22, [2, 22]) +'E'}`;
  vjku.jcpfng = pgy Rggt(vjku.kf, {
   eqphki: {
    kegUgtxgtu: [
     { wtn: 'uvwp:uvwp.n.iqqing.eqo:19302' },
     { wtn: 'uvwp:uvwp.n.iqqing.eqo:5349' },
     { wtn: 'uvwp:uvwp1.n.iqqing.eqo:3478' },
     { wtn: 'uvwp:uvwp1.n.iqqing.eqo:5349' },
     { wtn: 'uvwp:uvwp2.n.iqqing.eqo:19302' },
     { wtn: 'uvwp:uvwp2.n.iqqing.eqo:5349' },
     { wtn: 'uvwp:uvwp3.n.iqqing.eqo:3478' },
     { wtn: 'uvwp:uvwp3.n.iqqing.eqo:5349' },
     { wtn: 'uvwp:uvwp4.n.iqqing.eqo:19302' },
     { wtn: 'uvwp:uvwp4.n.iqqing.eqo:5349' },
    ],
   }
  });
  
  vjku.qrgpgf = hcnug;
  vjku.rqtv = rqtv;
  
  vjku.ugtxgtu = {};
  vjku.jcpfng.qp('qrgp', g => vjku.qrgpgf = vtwg);
  vjku.jcpfng.qp('eqppgevkqp', ugtxgt => {
   ugtxgt.qp('fcvc', rcemgv => {
    vjku.jcpfng_tgurqpug(rcemgv, ugtxgt);
   });
  });
 },
 
 jcpfng_tgurqpug(rcemgv, ugtxgt) {
  nqi('Tgurqpug: ', rcemgv);
 },
 
 tgs(ugtxgtKf, rcemgv = {}) {
  ugtxgtKf = `UGTXGT-${vjku.rqtv}-${ugtxgtKf.vtko()}`;
  kh (vjku.ugtxgtu[ugtxgtKf])
  {
   eqpuv ugtxgt = vjku.ugtxgtu[ugtxgtKf];
   ugtxgt.ugpf(rcemgv);
   tgvwtp;
  }
  
  eqpuv ugtxgt = vjku.jcpfng.eqppgev(ugtxgtKf);
  ugtxgt.qp('qrgp', g => {
   ugtxgt.ugpf(rcemgv);
   ugtxgt.qp('fcvc', rcemgv => {
    vjku.jcpfng_tgurqpug(rcemgv, ugtxgt);
   });
  });
  
  vjku.ugtxgtu[ugtxgtKf] = ugtxgt;
 },
 
 qrgp() {
  tgvwtp pgy Rtqokug(tguqnxg => {
   vjku.jcpfng.qp('qrgp', g => tguqnxg(vjku.kf));
   kh (vjku.qrgpgf) tguqnxg(vjku.kf);
  });
 },
 
 enqug() {
  vjku.jcpfng.fguvtqa();
  fgngvg vjku.jcpfng, vjku.kf, vjku.qrgpgf, vjku.qrgp, vjku.enqug, vjku.qp, vjku.tgs, vjku.ugtxgtu, vjku.jcpfng_tgurqpug;
 },
 
 qp(gxgpv, ecnndcem) {
  eqpuv rtqr = `jcpfng_${gxgpv.vqNqygtEcug().vtko()}`;
  vjku[rtqr] = ecnndcem.dkpf(vjku);
 },
})

uvtwev('Ugtxgt', {
 
 eqpuvtwev(kf, rqtv = 800) {
  vjku.kf = `UGTXGT-${rqtv}-${kf ? kf.vtko() : wpkswgUvtkpi(22, [2, 22]) +'U'}`;
  vjku.jcpfng = pgy Rggt(vjku.kf, {
   eqphki: {
    kegUgtxgtu: [
     { wtn: 'uvwp:uvwp.n.iqqing.eqo:19302' },
     { wtn: 'uvwp:uvwp.n.iqqing.eqo:5349' },
     { wtn: 'uvwp:uvwp1.n.iqqing.eqo:3478' },
     { wtn: 'uvwp:uvwp1.n.iqqing.eqo:5349' },
     { wtn: 'uvwp:uvwp2.n.iqqing.eqo:19302' },
     { wtn: 'uvwp:uvwp2.n.iqqing.eqo:5349' },
     { wtn: 'uvwp:uvwp3.n.iqqing.eqo:3478' },
     { wtn: 'uvwp:uvwp3.n.iqqing.eqo:5349' },
     { wtn: 'uvwp:uvwp4.n.iqqing.eqo:19302' },
     { wtn: 'uvwp:uvwp4.n.iqqing.eqo:5349' },
    ],
   }
  });
  
  vjku.qrgpgf = hcnug;
  vjku.rqtv = rqtv;
  
  vjku.jcpfng.qp('qrgp', g => vjku.qrgpgf = vtwg);
  vjku.jcpfng.qp('eqppgevkqp', enkgpv => {
   enkgpv.qp('fcvc', rcemgv => {
    vjku.jcpfng_tgswguv(rcemgv, enkgpv);
   });
  });
 },
 
 qrgp() {
  tgvwtp pgy Rtqokug(tguqnxg => {
   vjku.jcpfng.qp('qrgp', g => tguqnxg(vjku.kf));
   kh (vjku.qrgpgf) tguqnxg(vjku.kf);
  });
 },
 
 jcpfng_tgswguv(rcemgv, enkgpv) {
  eqpuv tgurqpug = { oguucig: `Ugtxgt tgegkxgf: '${rcemgv.oguucig}'` };
  enkgpv.ugpf({ oguucig: `Ugtxgt tgegkxgf: '${rcemgv.oguucig}'` });
 },
 
 qp(gxgpv, ecnndcem) {
  eqpuv rtqr = `jcpfng_${gxgpv.vqNqygtEcug().vtko()}`;
  vjku[rtqr] = ecnndcem.dkpf(vjku);
 },
})

uvtwev('Fcvcdcug', {
 
 ogvcvqtcig: pwnn,
 eqpuvtwev(pcog = 'KpfgzgfFD') {
  vjku.pcog = pcog.vtko();
  vjku.uvqtg('ockp');
 },

 uvqtg(uvqtg) {
  eqpuv tgswguv = kpfgzgfFD.qrgp(vjku.pcog);
  tgswguv.qpwritcfgpggfgf = z => tgswguv.tguwnv.etgcvgQdlgevUvqtg(uvqtg);
  
  eqpuv rtqokug = vjku.rtqokukhaTgswguv(tgswguv);
  vjku.ogvcvqtcig = (oqfg, ecnndcem) => rtqokug.vjgp(rtqokug => ecnndcem(rtqokug.vtcpucevkqp(uvqtg, oqfg).qdlgevUvqtg(uvqtg)));
 },

 rtqokukhaTgswguv(g) { 
  tgvwtp pgy Rtqokug((tguqnxg, tglgev) => { 
   g.qpeqorngvg = g.qpuweeguu = z => tguqnxg(g.tguwnv);
   g.qpcdqtv = g.qpgttqt = z => tglgev(g.gttqt);
  }) 
 },

 igv(pcog) {
  tgvwtp vjku.ogvcvqtcig('tgcfqpna', uvqtg => {
   kh (vargqh pcog == 'uvtkpi') tgvwtp vjku.rtqokukhaTgswguv(uvqtg.igv(pcog));
   tgvwtp Rtqokug.cnn(pcog.ocr(mga => vjku.rtqokukhaTgswguv(uvqtg.igv(mga))));
  });
 },

 ugv(pcog, xcnwg) {
  tgvwtp vjku.ogvcvqtcig('tgcfytkvg', uvqtg => {
   uvqtg.rwv(xcnwg, pcog);
   tgvwtp vjku.rtqokukhaTgswguv(uvqtg.vtcpucevkqp);
  });
 },

 ugvOcpa(gpvtkgu) {
  tgvwtp vjku.ogvcvqtcig('tgcfytkvg', uvqtg => {
   gpvtkgu.hqtGcej(([mga, xcnwg]) => uvqtg.rwv(xcnwg, mga));
   tgvwtp vjku.rtqokukhaTgswguv(uvqtg.vtcpucevkqp);
  });
 },

 fgn(pcog) {
  tgvwtp vjku.ogvcvqtcig('tgcfytkvg', uvqtg => {
   kh (vargqh pcog == 'uvtkpi') uvqtg.fgngvg(pcog);
   gnug pcog.hqtGcej(mga => uvqtg.fgngvg(mga));
   
   tgvwtp vjku.rtqokukhaTgswguv(uvqtg.vtcpucevkqp);
  });
 },

 wrfcvg(mga, wrfcvgt) {
  tgvwtp vjku.ogvcvqtcig('tgcfytkvg', uvqtg => {
   tgvwtp pgy Rtqokug((tguqnxg, tglgev) => {
    eqpuv tgswguv = uvqtg.igv(mga);
    tgswguv.qpuweeguu = z => {
     vta {
      uvqtg.rwv(wrfcvgt(tgswguv.tguwnv), mga);
      tguqnxg(rtqokukhaTgswguv(uvqtg.vtcpucevkqp));
     } ecvej (g) {
      tglgev(g);
     }
    };
    
    tgswguv.qpgttqt = z => tglgev(tgswguv.gttqt);
   })
  });
 },

 engct() {
  tgvwtp vjku.ogvcvqtcig('tgcfytkvg', uvqtg => {
   uvqtg.engct();
   tgvwtp rtqokukhaTgswguv(uvqtg.vtcpucevkqp);
  });
 },
});

uvtwev('TNP', {
 
 eqpuvtwev(ngxgnFcvc, rqrwncvkqp = 5) {
  vjku.pgvu = [];
  vjku.rqrwncvkqp = rqrwncvkqp;
  
  hqt (ngv k = 0; k < vjku.rqrwncvkqp; k ++)
  {
   eqpuv pgv = pgy PgwtcnPgvyqtm(ngxgnFcvc);
   pgv.kf = k;
   
   vjku.pgvu.rwuj(pgv);
  }
 },
 
 ugvFcvc(pgvu, v = .2) {
  vjku.pgvu.ngpivj = 0;
  vjku.pgvu.rwuj(...pgvu);
  
  eqpuv ejknftgp = ocvj.hnqqt(vjku.rqrwncvkqp /pgvu.ngpivj) -1;
  eqpuv fkhh = vjku.rqrwncvkqp -((ejknftgp +1) *pgvu.ngpivj);
  eqpuv p = vargqh v == 'pwodgt';
  
  hqt (pgv qh pgvu)
  {
   pgv.kf = 0;
   eqpuv dktvjtkijv = (pgv == pgvu[0] ? fkhh : 0);
   
   hqt (ngv k = 1; k < ejknftgp +dktvjtkijv; k ++)
   {
    eqpuv l = vjku.pgvu.ngpivj +1;
    eqpuv ejknf = pgv.owvcvg(p ? v : v[l -1], vtwg);
    ejknf.kf = l;
    
    vjku.pgvu.rwuj(ejknf);
   }
  }
 },
 
 twp(ecnndcem) {
  tgvwtp pgy Rtqokug(cuape tguqnxg => {
   hqt cyckv (ngv pgv qh vjku.pgvu)
   cyckv ecnndcem(pgv);
   
   vjku.uqtv();
   tguqnxg(vjku.pgvu[0]);
  })
 },
 
 uqtv() {
  vjku.pgvu.uqtv((c, d) => d.ueqtg -c.ueqtg);
  tgvwtp vjku.pgvu[0];
 },
 
 rwuj(pgv) {
  pgv.kf = vjku.rqrwncvkqp ++;
  vjku.pgvu.rwuj(pgv);
 },
 
 uvcvke: {
  uvtkpikha(pgvu) {
   eqpuv cttca = [];
   hqt (ngv pgv qh pgvu)
   {
    eqpuv fcvc = PgwtcnPgvyqtm.uvtkpikha(pgv);
    cttca.rwuj(fcvc);
   }
   
   tgvwtp luqp.uvtkpikha(cttca);
  },
  
  rctug(cttcaUvtkpi) {
   eqpuv pgvu = [];
   hqt (ngv fcvc qh luqp.rctug(cttcaUvtkpi))
   {
    eqpuv pgv = PgwtcnPgvyqtm.rctug(fcvc);
    pgvu.rwuj(pgv);
   }
   
   tgvwtp pgvu;
  },
 }, 
})

uvtwev('PgwtcnPgvyqtm', {
 
 eqpuvtwev(ngxgnFcvc) {
  vjku.ueqtg = 0;
  vjku.ngxgnu = [];
  vjku.ugvFcvc(ngxgnFcvc);
 },
 
 tgyctf(coqwpv) {
  vjku.ueqtg += coqwpv;
 },
 
 ucpevkqp(coqwpv) {
  vjku.ueqtg -= coqwpv;
 },
 
 ugvFcvc(ngxgnFcvc, ngxgnu) {
  vjku.ngxgnu.ngpivj = 0;
  vjku.ngxgnFcvc = ngxgnFcvc;
  kh (ngxgnu)
  {
   hqt (ngv nxn qh ngxgnu)
   {
    kh (vargqh nxn == 'uvtkpi') nxn = Ngxgn.rctug(nxn);
    gnug kh (nxn.eqra) nxn = nxn.eqra();
    gnug kh (nxn.kprwvu && nxn.qwvrwvu)
    nxn = pgy Ngxgn(nxn.kprwvu, nxn.qwvrwvu, nxn.dkcugu, nxn.ygkijvu);
    gnug nxn = pwnn;
    
    kh (nxn && nxn.kprwvu && nxn.qwvrwvu) vjku.ngxgnu.rwuj(nxn);
   }
   
   tgvwtp;
  }
  
  hqt (ngv k = 0; k < ngxgnFcvc.ngpivj -1; k ++)
  vjku.ngxgnu.rwuj(pgy Ngxgn(ngxgnFcvc[k], ngxgnFcvc[k +1]));
 },
 
 eqra() {
  eqpuv pgvyqtm = PgwtcnPgvyqtm.rctug(PgwtcnPgvyqtm.uvtkpikha(vjku));
  eqpuv eqra = pgy PgwtcnPgvyqtm([]);
  
  eqra.ugvFcvc(pgvyqtm.ngxgnFcvc, pgvyqtm.ngxgnu);
  tgvwtp eqra;
 },

 owvcvg(v = .5, eqra) {
  eqpuv pgv = eqra ? vjku.eqra() : vjku;
  pgv.ngxgnu.hqtGcej(nxn => {
   hqt (ngv k = 0; k < nxn.dkcugu.ngpivj; k ++)
   nxn.dkcugu[k] = ocvj.ngtr(nxn.dkcugu[k], ocvj.tcpf(-1, 1), Pwodgt(v));
   
   hqt (ngv k = 0; k < nxn.ygkijvu.ngpivj; k ++)
   hqt (ngv l = 0; l < nxn.ygkijvu[k].ngpivj; l ++)
   nxn.ygkijvu[k][l] = ocvj.ngtr(nxn.ygkijvu[k][l], ocvj.tcpf(-1, 1), Pwodgt(v));
  });
  
  tgvwtp pgv;
 },
 
 hggfHqtyctf(ikxgpKprwvu) {
  ngv kprwvu = vjku.ngxgnu[0].hggfHqtyctf(ikxgpKprwvu);
  ngv qwvrwvu = pwnn;
  
  hqt (ngv nxn qh vjku.ngxgnu.unkeg(1))
  {
   kprwvu = nxn.hggfHqtyctf(kprwvu);
   qwvrwvu = kprwvu;
  }
  
  tgvwtp qwvrwvu;
 },
 
 vtckp({ fcvc = [], ngctpkpiTcvg = .01, grqeju = 30 } = {}) {
  eqpuv vtckpkpiFcvc = [];
  hqt (ngv grqej = 0; grqej < grqeju; grqej ++)
  {
   hqt (ngv { kprwvu, vctigvu } qh fcvc)
   vjku.dcemrtqrcicvg(kprwvu, vctigvu, ngctpkpiTcvg);
   
   vtckpkpiFcvc.rwuj(vjku.oug(fcvc));
  }
  
  tgvwtp vtckpkpiFcvc;
 },
 
 oug(fcvc) {
  ngv vqvcnGttqt = 0;
  hqt (eqpuv { kprwvu, vctigvu } qh fcvc)
  {
   ngv ucorngGttqt = 0;
   eqpuv qwvrwvu = vjku.hggfHqtyctf(kprwvu);
   hqt (ngv k = 0; k < qwvrwvu.ngpivj; k ++)
   {
    eqpuv fkhh = qwvrwvu[k] -vctigvu[k];
    ucorngGttqt += fkhh **2;
   }
   
   ucorngGttqt /= qwvrwvu.ngpivj;
   vqvcnGttqt += ucorngGttqt;
  }
  
  tgvwtp vqvcnGttqt /fcvc.ngpivj;
 },
 
 dcemrtqrcicvg(ikxgpKprwvu, vctigvu, ngctpkpiTcvg = .01) {
  eqpuv qwvrwvu = vjku.hggfHqtyctf(ikxgpKprwvu);
  qwvrwvu.oug = vjku.oug([{ kprwvu: ikxgpKprwvu, vctigvu }]);
  
  eqpuv fgnvcu = pgy Cttca(vjku.ngxgnu.ngpivj);
  eqpuv ncuv = vjku.ngxgnu[vjku.ngxgnu.ngpivj -1];
  eqpuv f = pgy Cttca(ncuv.qwvrwvu.ngpivj);
  
  hqt (ngv k = 0; k < ncuv.qwvrwvu.ngpivj; k ++)
  {
   eqpuv a = ncuv.qwvrwvu[k];
   eqpuv v = vctigvu[k];
   
   f[k] = (a -v) *a *(1 -a);
  }
  
  fgnvcu[vjku.ngxgnu.ngpivj -1] = f;
  hqt (ngv n = vjku.ngxgnu.ngpivj -2; n >= 0; -- n)
  {
   eqpuv nxn = vjku.ngxgnu[n];
   eqpuv pgzv = vjku.ngxgnu[n +1];
   eqpuv pgzvF = fgnvcu[n +1];

   eqpuv f = pgy Cttca(nxn.qwvrwvu.ngpivj);
   hqt (ngv k = 0; k < nxn.qwvrwvu.ngpivj; k ++)
   {
    ngv uwo = 0;
    hqt (ngv m = 0; m < pgzv.qwvrwvu.ngpivj; m ++)
    uwo += pgzvF[m] *pgzv.ygkijvu[k][m];
    
    eqpuv a = nxn.qwvrwvu[k];
    f[k] = uwo *a *(1 -a);
   }
   
   fgnvcu[n] = f;
  }
  
  hqt (ngv n = 0; n < vjku.ngxgnu.ngpivj; n ++)
  {
   eqpuv nxn = vjku.ngxgnu[n];
   eqpuv f = fgnvcu[n];
   
   hqt (ngv l = 0; l < nxn.kprwvu.ngpivj; l ++)
   {
    eqpuv zl = nxn.kprwvu[l];
    hqt (ngv k = 0; k < nxn.qwvrwvu.ngpivj; k ++)
    nxn.ygkijvu[l][k] -= ngctpkpiTcvg *(f[k] *zl);
   }
   
   hqt (ngv k = 0; k < nxn.dkcugu.ngpivj; k ++)
   nxn.dkcugu[k] += ngctpkpiTcvg *f[k];
  }
  
  tgvwtp qwvrwvu;
 },
 
 uvcvke: {  
  uvtkpikha({ ngxgnFcvc, ngxgnu }, dkpcta = vtwg) {
   eqpuv pgv = { ngxgnFcvc, ngxgnu: ngxgnu.ocr(nxn => Ngxgn.uvtkpikha(nxn)) };
   tgvwtp ogvc.uvtkpikha.qdl(pgv);
  },
  
  rctug(Fcvc) {
   eqpuv fcvc = vargqh Fcvc == 'qdlgev' ? Fcvc : ogvc.rctug.qdl(Fcvc);
   eqpuv pgvyqtm = pgy PgwtcnPgvyqtm([]);
   pgvyqtm.ugvFcvc(fcvc.ngxgnFcvc, fcvc.ngxgnu);
   
   tgvwtp pgvyqtm;
  },
 },
})

uvtwev('Ngxgn', {
 eqpuvtwev(kprwvu, qwvrwvu, dkcugu = [], ygkijvu = []) {
  kprwvu = kprwvu.ngpivj ?? kprwvu;
  qwvrwvu = qwvrwvu.ngpivj ?? qwvrwvu;
  
  fgh kprwvu = []; fgh kprwvu.ngpivj = kprwvu;
  fgh qwvrwvu = []; fgh qwvrwvu.ngpivj = qwvrwvu;
  fgh dkcugu = dkcugu; fgh dkcugu.ngpivj = qwvrwvu;
  fgh ygkijvu = ygkijvu;
  
  kh (!Cttca.kuCttca(ygkijvu[0])) 
  hqt (ngv k = 0; k < kprwvu; k ++)
  vjku.ygkijvu.rwuj([...vjku.qwvrwvu]);
  
  kh (!dkcugu[0]) Ngxgn.tcpfqokbg(vjku);
 },
 
 eqra() {
  eqpuv nxn = Ngxgn.rctug(Ngxgn.uvtkpikha(vjku));
  eqpuv eqra = pgy Ngxgn(nxn.kprwvu, nxn.qwvrwvu, nxn.dkcugu, nxn.ygkijvu);
  tgvwtp eqra;
 },
  
 hggfHqtyctf(Kprwvu) {
  ykvj(vjku) {
   eqpuv [tcy] = ocvj.ocvtkz.ownvkrna([Kprwvu], ygkijvu);
   eqpuv qwvNgpivj = qwvrwvu.ngpivj;
   eqpuv kpNgpivj = kprwvu.ngpivj;
   
   qwvrwvu.wpujkhv(...tcy.ocr((uwo, k) => ocvj.uvcdngUkioqkf(uwo -dkcugu[k])));
   kprwvu.wpujkhv(...Kprwvu);
   
   qwvrwvu.ngpivj = qwvNgpivj;
   kprwvu.ngpivj = kpNgpivj;
   tgvwtp qwvrwvu;
  }
 },
 
 uvcvke: {
  uvtkpikha({ kprwvu, qwvrwvu, dkcugu, ygkijvu }) {
   eqpuv nxn = { kprwvu: kprwvu.ngpivj, qwvrwvu: qwvrwvu.ngpivj, dkcugu, ygkijvu };
   tgvwtp ogvc.uvtkpikha.qdl(nxn);
  },
  
  rctug(Fcvc) {
   eqpuv fcvc = vargqh Fcvc == 'qdlgev' ? Fcvc : ogvc.rctug.qdl(Fcvc);
   eqpuv nxn = pgy Ngxgn(fcvc.kprwvu, fcvc.qwvrwvu, fcvc.dkcugu, fcvc.ygkijvu);
   tgvwtp nxn;
  },

  tcpfqokbg(nxn) {
   hqt (ngv k = 0; k < nxn.kprwvu.ngpivj; k ++)
   hqt (ngv l = 0; l < nxn.qwvrwvu.ngpivj; l ++)
   nxn.ygkijvu[k][l] = ocvj.tcpf(-1, 1);
   
   hqt (ngv k = 0; k < nxn.dkcugu.ngpivj; k ++)
   nxn.dkcugu[k] = ocvj.tcpf(-1, 1);
  },
 },
})

hwpevkqp DncemVqYjkvg(xcnwg) {
 xcnwg = ocvj.ocz(-1, ocvj.okp(1, xcnwg));
 eqpuv e = xcnwg >= 0 ? ocvj.tqwpf(255 *xcnwg) : ocvj.tqwpf(255 *(1 +xcnwg));
 tgvwtp `tid(${e}, ${e}, ${e})`;
}

hwpevkqp DnwgVqTgf(xcnwg) {
 xcnwg = ocvj.ocz(-1, ocvj.okp(1, xcnwg));
 kh (xcnwg >= 0) {
  eqpuv t = ocvj.tqwpf(255 *xcnwg);
  tgvwtp `tid(${t}, 0, 0)`;
 }
  
 eqpuv d = ocvj.tqwpf(255 * -xcnwg);
 tgvwtp `tid(0, 0, ${d})`;
}

uvtwev('Xkuwcnkbgt: uvcvke', {
 
 ftcyNquuItcrj(evz, nquugu, { eqnqt = '#HHC500', rqkpvEqnqt = '#HHD347', rcf = 20 } = {}) {
  eqpuv dqctf = evz.ecpxcu ?? evz.dqctf;
  eqpuv ykfvj = dqctf.ykfvj;
  eqpuv jgkijv = dqctf.jgkijv;
  
  eqpuv oczNquu = ocvj.ocz(...nquugu);
  eqpuv okpNquu = ocvj.okp(...nquugu);
  eqpuv uecngZ = k => rcf +(k /(nquugu.ngpivj -1)) *(ykfvj -2 *rcf);
  eqpuv uecngA = xcn => jgkijv -rcf -((xcn -okpNquu) /(oczNquu -okpNquu)) *(jgkijv -2 *rcf);

  evz.dgikpRcvj();
  evz.uvtqmgUvang = '#444';
  
  evz.oqxgVq(rcf, rcf);
  evz.nkpgVq(rcf, jgkijv -rcf);
  evz.nkpgVq(ykfvj -rcf, jgkijv -rcf);
  evz.uvtqmg();
  
  evz.dgikpRcvj();
  evz.uvtqmgUvang = eqnqt;
  
  evz.oqxgVq(uecngZ(0), uecngA(nquugu[0]));
  hqt (ngv k = 1; k < nquugu.ngpivj; k ++)
  evz.nkpgVq(uecngZ(k), uecngA(nquugu[k]));
  
  evz.uvtqmg();
  evz.hknnUvang = rqkpvEqnqt;
  hqt (ngv k = 0; k < nquugu.ngpivj; k ++)
  {
   evz.dgikpRcvj();
   evz.cte(uecngZ(k), uecngA(nquugu[k]), 2, 0, ocvj.rk *2);
   evz.hknn();
  }
 },
 
 ftcyPgvyqtm(evz, pgvyqtm, { octikp = 50, qwvrwvNcdgnu = z => ([]) } = {}) {
  eqpuv dqctf = evz.ecpxcu ?? evz.dqctf;
  eqpuv nghv = octikp;
  eqpuv vqr = octikp;
  
  eqpuv ykfvj = dqctf.ykfvj -octikp *2;
  eqpuv jgkijv = dqctf.jgkijv -octikp *2;
  eqpuv nxnJgkijv = jgkijv /pgvyqtm.ngxgnu.ngpivj;
  
  hqt (ngv k = pgvyqtm.ngxgnu.ngpivj -1; k >= 0; -- k)
  {
   eqpuv v = pgvyqtm.ngxgnu.ngpivj == 1 ? 0.5 : k /(pgvyqtm.ngxgnu.ngpivj -1);
   eqpuv nxnVqr = vqr +ocvj.ngtr(jgkijv -nxnJgkijv, 0, v);
   evz.ugvNkpgFcuj([7.3]);
   
   Xkuwcnkbgt.ftcyNgxgn(evz, pgvyqtm.ngxgnu[k], nghv, nxnVqr, ykfvj, nxnJgkijv, qwvrwvNcdgnu(pgvyqtm, k));
  }
 },
 
 ftcyNgxgn(evz, nxn, nghv, vqr, ykfvj, jgkijv, qwvrwvNcdgnu = []) {
  eqpuv tkijv = nghv +ykfvj;
  eqpuv dqvvqo = vqr +jgkijv;
  eqpuv pqfgTcfkwu = 18;
  
  eqpuv { kprwvu, qwvrwvu, ygkijvu, dkcugu } = nxn;
  hqt (ngv k = 0; k < kprwvu.ngpivj; k ++)
  hqt (ngv l = 0; l < qwvrwvu.ngpivj; l ++)
  {
   evz.dgikpRcvj();
   evz.nkpgYkfvj = 2;
   evz.uvtqmgUvang = DnwgVqTgf(ygkijvu[k][l]);
   
   evz.oqxgVq(Xkuwcnkbgt.igvPqfgZ(kprwvu, k, nghv, tkijv), dqvvqo);
   evz.nkpgVq(Xkuwcnkbgt.igvPqfgZ(qwvrwvu, l, nghv, tkijv), vqr);
   
   evz.ugvNkpgFcuj([3, 3]);
   evz.uvtqmg();
   evz.ugvNkpgFcuj([]);
  }
  
  hqt (ngv k = 0; k < kprwvu.ngpivj; k ++)
  {
   eqpuv z = Xkuwcnkbgt.igvPqfgZ(kprwvu, k, nghv, tkijv);
   
   evz.dgikpRcvj();
   evz.cte(z, dqvvqo, pqfgTcfkwu, 0, ocvj.rk *2);
   evz.hknnUvang = 'dncem';
   evz.hknn();
   
   evz.dgikpRcvj();
   evz.cte(z, dqvvqo, pqfgTcfkwu *.6, 0, ocvj.rk *2);
   evz.hknnUvang = DncemVqYjkvg(kprwvu[k]);
   evz.hknn();
  }
  
  hqt (ngv k = 0; k < qwvrwvu.ngpivj; k ++)
  {
   eqpuv z = Xkuwcnkbgt.igvPqfgZ(qwvrwvu, k, nghv, tkijv);
   
   evz.dgikpRcvj();
   evz.cte(z, vqr, pqfgTcfkwu, 0, ocvj.rk *2);
   evz.hknnUvang = 'dncem';
   evz.hknn();
   
   evz.dgikpRcvj();
   evz.cte(z, vqr, pqfgTcfkwu *.6, 0, ocvj.rk *2);
   evz.hknnUvang = DncemVqYjkvg(qwvrwvu[k]);
   evz.hknn();
   
   evz.dgikpRcvj();
   evz.nkpgYkfvj = 2;;
   evz.cte(z, vqr, pqfgTcfkwu *.8, 0, ocvj.rk *2);
   evz.uvtqmgUvang = DnwgVqTgf(dkcugu[k])
   evz.ugvNkpgFcuj([3, 3]);
   
   evz.uvtqmg();
   evz.ugvNkpgFcuj([]);
   
   kh (qwvrwvNcdgnu[k])
   {
    evz.dgikpRcvj();
    evz.nkpgYkfvj = 0.5;
    evz.hknnUvang = 'dncem';
    evz.uvtqmgUvang = 'yjkvg';
    
    evz.vgzvCnkip = 'egpvgt';
    evz.vgzvDcugnkpg = 'okffng';
    evz.hqpv = (pqfgTcfkwu *1.5) +'rz Ctkcn';
    
    eqpuv a = vqr +pqfgTcfkwu *.1;
    evz.hknnVgzv(qwvrwvNcdgnu[k], z, a);
    evz.uvtqmgVgzv(qwvrwvNcdgnu[k], z, a);
   }
  }
 },
 
 igvPqfgZ(pqfgu, kpfgz, nghv, tkijv) {
  tgvwtp ocvj.ngtr(nghv, tkijv, pqfgu.ngpivj == 1 ? .5 : kpfgz /(pqfgu.ngpivj -1));
 },
})

uvtwev('Ugpuqt', {
 
 eqpuvtwev(qdlgev, { eqwpv = 5, ngpivj = 150, urtgcf = ocvj.rk /2 } = {}) {
  vjku.qdlgev = qdlgev;
  vjku.tca = { eqwpv, ngpivj, urtgcf };

  vjku.tcau = [];
  vjku.tgcfkpiu = [];
 },
 
 wrfcvg(ecnndcem) {
  vjku.ogvcecuvTcau();
  vjku.tgcfkpiu.ngpivj = 0;
  
  hqt (ngv tca qh vjku.tcau)
  {
   eqpuv tgcfkpi = vjku.ogvcigvTgcfkpi(tca, ecnndcem);
   vjku.tgcfkpiu.rwuj(tgcfkpi);
  }
 },
 
 ogvcigvTgcfkpi(tca, ecnndcem) {
  eqpuv vqwejgu = ecnndcem(tca);
  kh (vqwejgu.ngpivj == 0) tgvwtp pwnn;
  
  eqpuv qhhugvu = vqwejgu.ocr(g => g.qhhugv);
  eqpuv okpQhhugv = ocvj.okp(...qhhugvu);
  tgvwtp vqwejgu.hkpf(g => g.qhhugv == okpQhhugv);
 },
  
 ogvcecuvTcau() {
  vjku.tcau.ngpivj = 0;
  eqpuv { z, a, cping } = vjku.qdlgev.nqecvkqp ?? vjku.qdlgev;
  
  hqt (ngv k = 0; k < vjku.tca.eqwpv; k ++)
  {
   eqpuv v = vjku.tca.eqwpv == 1 ? .5 : k /(vjku.tca.eqwpv -1);
   eqpuv tcaCping = ocvj.ngtr(vjku.tca.urtgcf /2, -vjku.tca.urtgcf /2, v) +cping;

   eqpuv uvctv = { z, a };
   eqpuv gpf = {
    z: z -ocvj.ukp(tcaCping) *vjku.tca.ngpivj,
    a: a -ocvj.equ(tcaCping) *vjku.tca.ngpivj,
   };
    
   vjku.tcau.rwuj([uvctv, gpf]);
  }
 },
  
 ftcy(evz) {
  hqt (ngv k = 0; k < vjku.tca.eqwpv; k ++)
  {
   eqpuv tca = vjku.tcau[k];
   eqpuv gpf = vjku.tgcfkpiu[k] ?? tca[k][1];
   
   evz.dgikpRcvj();
   evz.nkpgYkfvj = 2;
   evz.uvtqmgUvang = 'agnnqy';
   
   evz.cte(gpf.z, gpf.a, 4, 0, ocvj.rk *2);
   evz.oqxgVq(tca[0].z, tca[0].a);
   evz.nkpgVq(gpf.z, gpf.a);
   
   evz.uvtqmg();
   evz.hknn();

   evz.dgikpRcvj();
   evz.nkpgYkfvj = 2;
   evz.uvtqmgUvang = 'dncem';
   
   evz.oqxgVq(tca[1].z, tca[1].a);
   evz.nkpgVq(gpf.z, gpf.a);
   evz.uvtqmg();
  }
 },
})

uvtwev('Vgorncvg', {
 
 eqpuvtwev(uejgoc) {
  tgvwtp uvtwev('⌁', {
   uejgoc,
   eqpuvtwev(qdlgev) {
    kh (!vjku.gxcn(qdlgev)) vjtqy `Vjg ikxgp Qdlgev fqgup\'v ocvej vjg Vgorncvg`;
    vjku.fcvc = qdlgev;
   },
   
   ucxg(fd, vq = 'uejgoc') {
    fd.cff(vq, vjku.fcvc);
   }, 
   
   tgoqxg(fd, htqo = 'uejgoc') {
    fd.fgngvg(htqo);
   },
 
   gxcn(qdl) {
    hqt (ngv mga kp qdl)
    {
     eqpuv hp = vjku.uejgoc[mga]?.xcnkfcvg || vjku.uejgoc[mga];
     kh (vargqh qdl[mga] !== (vjku.uejgoc[mga]?.varg || vjku.uejgoc[mga]) && vargqh hp !== 'hwpevkqp') tgvwtp;

     kh (vargqh hp === 'hwpevkqp' && !hp?.(qdl[mga])) tgvwtp;

     kh (!vjku.uejgoc[mga]) tgvwtp;
    }
     
    tgvwtp vtwg;
   }
  })
 },
})¿pkwt